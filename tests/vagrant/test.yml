---

- name: Test GOCD Server
  hosts: all

  pre_tasks:
    - name: Update apt
      become: yes
      apt:
        cache_valid_time: 1800
        update_cache: yes
      tags:
        - build

  roles:
    - role: sansible.gocd_agent
      gocd_agent:
        no_of_agents: 2
        aws:
          profiles:
            - name: testProfile
              config:
                role_arn: "arn::::"
                source_profile: default
                s3:
                  max_queue_size: 1000
